<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Mattock::CascadingDefinition
  
    &mdash; mattock-0.4.0 RDoc
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Mattock.html" title="Mattock (module)">Mattock</a></span></span>
     &raquo; 
    <span class="title">CascadingDefinition</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Mattock::CascadingDefinition
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
      <dt class="r1">Includes:</dt>
      <dd class="r1"><span class='object_link'><a href="Configurable.html" title="Mattock::Configurable (module)">Configurable</a></span></dd>
      
    
  
  
    <dt class="r2">Included in:</dt>
    <dd class="r2"><span class='object_link'><a href="ConfigurableTask.html" title="Mattock::ConfigurableTask (module)">ConfigurableTask</a></span>, <span class='object_link'><a href="TaskLib.html" title="Mattock::TaskLib (class)">TaskLib</a></span></dd>
    
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/mattock/cascading-definition.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Collects shared configuration management behavior for TaskLibs and Tasks</p>

<p>The chain of events in initialize looks like:</p>

<pre class="code ruby"><code><span class='id identifier rubyid_setup_defaults'>setup_defaults</span>
<span class='id identifier rubyid_default_configuration'>default_configuration</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_tasklibs'>tasklibs</span><span class='rparen'>)</span>

<span class='kw'>yield</span> <span class='kw'>self</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

<span class='id identifier rubyid_resolve_configuration'>resolve_configuration</span>
<span class='id identifier rubyid_confirm_configuration'>confirm_configuration</span>

<span class='id identifier rubyid_define'>define</span></code></pre>

<p>Override those methods to adjust how a TaskLib processes its options</p>

<p>The only method not defined here is <span class='object_link'><a href="Configurable.html#setup_defaults-instance_method" title="Mattock::Configurable#setup_defaults (method)">Mattock::Configurable#setup_defaults</a></span></p>

<p>For an overview see <span class='object_link'><a href="TaskLib.html" title="Mattock::TaskLib (class)">TaskLib</a></span></p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Rake Tasks Defined</h2>
  <pre class="code ruby">
</pre>




  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="Configurable/ClassMethods.html" title="Mattock::Configurable::ClassMethods (module)">Mattock::Configurable::ClassMethods</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Configurable/ClassMethods.html#RequiredField-constant" title="Mattock::Configurable::ClassMethods::RequiredField (constant)">Mattock::Configurable::ClassMethods::RequiredField</a></span></p>






  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#confirm_configuration-instance_method" title="#confirm_configuration (instance method)">- (Object) <strong>confirm_configuration</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Last step before definition: confirm that all the configuration settings
have good values.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#confirm_step-instance_method" title="#confirm_step (instance method)">- (Object) <strong>confirm_step</strong>(step) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#confirm_steps-instance_method" title="#confirm_steps (instance method)">- (Object) <strong>confirm_steps</strong>(*steps) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#default_configuration-instance_method" title="#default_configuration (instance method)">- (Object) <strong>default_configuration</strong>(*tasklibs) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets default values for library settings.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#define-instance_method" title="#define (instance method)">- (Object) <strong>define</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Any useful TaskLib will override this to define tasks, essentially like a
templated Rakefile snippet.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resolve_configuration-instance_method" title="#resolve_configuration (instance method)">- (Object) <strong>resolve_configuration</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Called after the configuration block has been called, so secondary
configurations can be set up.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup_cascade-instance_method" title="#setup_cascade (instance method)">- (Object) <strong>setup_cascade</strong>(*other_definitions) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Configurable.html" title="Mattock::Configurable (module)">Configurable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Configurable.html#check_required-instance_method" title="Mattock::Configurable#check_required (method)">#check_required</a></span>, <span class='object_link'><a href="Configurable.html#copy_settings-instance_method" title="Mattock::Configurable#copy_settings (method)">#copy_settings</a></span>, <span class='object_link'><a href="Configurable.html#copy_settings_to-instance_method" title="Mattock::Configurable#copy_settings_to (method)">#copy_settings_to</a></span>, <span class='object_link'><a href="Configurable.html#fail_unless_set-instance_method" title="Mattock::Configurable#fail_unless_set (method)">#fail_unless_set</a></span>, <span class='object_link'><a href="Configurable.html#field_unset%3F-instance_method" title="Mattock::Configurable#field_unset? (method)">#field_unset?</a></span>, <span class='object_link'><a href="Configurable.html#proxy_settings-instance_method" title="Mattock::Configurable#proxy_settings (method)">#proxy_settings</a></span>, <span class='object_link'><a href="Configurable.html#proxy_settings_to-instance_method" title="Mattock::Configurable#proxy_settings_to (method)">#proxy_settings_to</a></span>, <span class='object_link'><a href="Configurable.html#proxy_value-instance_method" title="Mattock::Configurable#proxy_value (method)">#proxy_value</a></span>, <span class='object_link'><a href="Configurable.html#setup_defaults-instance_method" title="Mattock::Configurable#setup_defaults (method)">#setup_defaults</a></span>, <span class='object_link'><a href="Configurable.html#to_hash-instance_method" title="Mattock::Configurable#to_hash (method)">#to_hash</a></span>, <span class='object_link'><a href="Configurable.html#unset%3F-instance_method" title="Mattock::Configurable#unset? (method)">#unset?</a></span>, <span class='object_link'><a href="Configurable.html#unset_defaults_guard-instance_method" title="Mattock::Configurable#unset_defaults_guard (method)">#unset_defaults_guard</a></span>, <span class='object_link'><a href="Configurable.html#unset_defaults_guard-class_method" title="Mattock::Configurable.unset_defaults_guard (method)">unset_defaults_guard</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Configurable/ClassMethods.html" title="Mattock::Configurable::ClassMethods (module)">Mattock::Configurable::ClassMethods</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Configurable/ClassMethods.html#copy_settings-instance_method" title="Mattock::Configurable::ClassMethods#copy_settings (method)">#copy_settings</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#default_value_for-instance_method" title="Mattock::Configurable::ClassMethods#default_value_for (method)">#default_value_for</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#default_values-instance_method" title="Mattock::Configurable::ClassMethods#default_values (method)">#default_values</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#field_metadata-instance_method" title="Mattock::Configurable::ClassMethods#field_metadata (method)">#field_metadata</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#field_names-instance_method" title="Mattock::Configurable::ClassMethods#field_names (method)">#field_names</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#included-instance_method" title="Mattock::Configurable::ClassMethods#included (method)">#included</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#inspect_instance-instance_method" title="Mattock::Configurable::ClassMethods#inspect_instance (method)">#inspect_instance</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#missing_required_fields_on-instance_method" title="Mattock::Configurable::ClassMethods#missing_required_fields_on (method)">#missing_required_fields_on</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#nested-instance_method" title="Mattock::Configurable::ClassMethods#nested (method)">#nested</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#nil_fields-instance_method" title="Mattock::Configurable::ClassMethods#nil_fields (method)">#nil_fields</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#required_fields-instance_method" title="Mattock::Configurable::ClassMethods#required_fields (method)">#required_fields</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#runtime_required_fields-instance_method" title="Mattock::Configurable::ClassMethods#runtime_required_fields (method)">#runtime_required_fields</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#runtime_setting-instance_method" title="Mattock::Configurable::ClassMethods#runtime_setting (method)">#runtime_setting</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#set_defaults_on-instance_method" title="Mattock::Configurable::ClassMethods#set_defaults_on (method)">#set_defaults_on</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#setting-instance_method" title="Mattock::Configurable::ClassMethods#setting (method)">#setting</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#settings-instance_method" title="Mattock::Configurable::ClassMethods#settings (method)">#settings</a></span>, <span class='object_link'><a href="Configurable/ClassMethods.html#to_hash-instance_method" title="Mattock::Configurable::ClassMethods#to_hash (method)">#to_hash</a></span></p>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="confirm_configuration-instance_method">
  
    - (<tt>Object</tt>) <strong>confirm_configuration</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Last step before definition: confirm that all the configuration settings
have good values.  The default ensures that required settings have been
given values.  Very much shortens the debugging cycle when using TaskLibs
if this is well written.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


79
80
81
82</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mattock/cascading-definition.rb', line 79</span>

<span class='kw'>def</span> <span class='id identifier rubyid_confirm_configuration'>confirm_configuration</span>
  <span class='id identifier rubyid_confirm_step'>confirm_step</span><span class='lparen'>(</span><span class='symbol'>:confirm_configuration</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_check_required'>check_required</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="confirm_step-instance_method">
  
    - (<tt>Object</tt>) <strong>confirm_step</strong>(step) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mattock/cascading-definition.rb', line 52</span>

<span class='kw'>def</span> <span class='id identifier rubyid_confirm_step'>confirm_step</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='rparen'>)</span>
  <span class='ivar'>@steps</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_step'>step</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="confirm_steps-instance_method">
  
    - (<tt>Object</tt>) <strong>confirm_steps</strong>(*steps) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


42
43
44
45
46
47
48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mattock/cascading-definition.rb', line 42</span>

<span class='kw'>def</span> <span class='id identifier rubyid_confirm_steps'>confirm_steps</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_steps'>steps</span><span class='rparen'>)</span>
  <span class='ivar'>@steps</span> <span class='op'>=</span> <span class='id identifier rubyid_steps'>steps</span>
  <span class='kw'>yield</span>
  <span class='kw'>unless</span> <span class='ivar'>@steps</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='comment'>#Otherwise, it's very easy to forget the 'super' statement and leave
</span>    <span class='comment'>#essential configuration out.  The result is really confusing
</span>    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbrace'>}</span><span class='tstring_content'> didn't run superclass step</span><span class='embexpr_beg'>#{</span><span class='ivar'>@steps</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@steps</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_content'> (put a 'super' in appropriate methods)</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="default_configuration-instance_method">
  
    - (<tt>Object</tt>) <strong>default_configuration</strong>(*tasklibs) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets default values for library settings</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>tasklibs</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="TaskLib.html" title="Mattock::TaskLib (class)">TaskLib</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Other libs upon which this one depends to set its defaults</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mattock/cascading-definition.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_default_configuration'>default_configuration</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_tasklibs'>tasklibs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_confirm_step'>confirm_step</span><span class='lparen'>(</span><span class='symbol'>:default_configuration</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="define-instance_method">
  
    - (<tt>Object</tt>) <strong>define</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Any useful TaskLib will override this to define tasks, essentially like a
templated Rakefile snippet.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mattock/cascading-definition.rb', line 87</span>

<span class='kw'>def</span> <span class='id identifier rubyid_define'>define</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="resolve_configuration-instance_method">
  
    - (<tt>Object</tt>) <strong>resolve_configuration</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Called after the configuration block has been called, so secondary
configurations can be set up.  For instance, consider:</p>

<pre class="code ruby"><code><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_command'>command</span> <span class='op'>||=</span> <span class='id identifier rubyid_bin_dir'>bin_dir</span> <span class='op'>+</span> <span class='id identifier rubyid_command_name'>command_name</span></code></pre>

<p>The full path to the command could be set in the configuration block in the
Rakefile, or if bin_dir and command_name are set, we can put those
together.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mattock/cascading-definition.rb', line 71</span>

<span class='kw'>def</span> <span class='id identifier rubyid_resolve_configuration'>resolve_configuration</span>
  <span class='id identifier rubyid_confirm_step'>confirm_step</span><span class='lparen'>(</span><span class='symbol'>:resolve_configuration</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="setup_cascade-instance_method">
  
    - (<tt>Object</tt>) <strong>setup_cascade</strong>(*other_definitions) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/mattock/cascading-definition.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_setup_cascade'>setup_cascade</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_other_definitions'>other_definitions</span><span class='rparen'>)</span>
  <span class='ivar'>@runtime</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_setup_defaults'>setup_defaults</span>

  <span class='id identifier rubyid_confirm_steps'>confirm_steps</span><span class='lparen'>(</span><span class='symbol'>:default_configuration</span><span class='comma'>,</span> <span class='symbol'>:resolve_configuration</span><span class='comma'>,</span> <span class='symbol'>:confirm_configuration</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_default_configuration'>default_configuration</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_other_definitions'>other_definitions</span><span class='rparen'>)</span>

    <span class='kw'>yield</span> <span class='kw'>self</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

    <span class='id identifier rubyid_resolve_configuration'>resolve_configuration</span>
    <span class='id identifier rubyid_confirm_configuration'>confirm_configuration</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_define'>define</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Mar 29 18:08:41 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.3 (ruby-1.9.3).
</div>

  </body>
</html>